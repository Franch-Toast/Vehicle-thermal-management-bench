# 上位机的使用方法

## 上位机使用说明

1. 上位机的运行环境需为Windows10及以上操作系统；
2. 电脑需要安装USB串口驱动

## 上位机界面

![1](.\pic\1.png)

## 上位机使用说明

### 上位机的启动

1. **点击 `扫描串口` 按钮，并选择对应的端口。**上位机会自动扫描连接电脑的串口（需要安装串口驱动），确认与开发板连接的串口的端口号并在下拉框中勾选对应的端口。
2. **点击 `打开串口` 按钮。**如果不打开串口，在点击执行、停机等按钮时会提示错误。
3. **设置各元件的控制参数，点击 `确认执行` 按钮。**如果要在不停机的情况下修改控制参数，直接再次点击 `确认执行` 按钮即可。在点击 `确认执行` 按钮后下位机会向上位机传输台架的状态信息。
4. **点击 `停机` 按钮，让压缩机、WPTC全部关闭。**如果关闭失败会提示错误，停机后下位机会停止传输数据。

### 各控制元件参数填写说明

#### 压缩机

压缩机共有三个可修改参数，当压缩机开启状态选择为`停机`时，无论转速和最大功率设置为多少，压缩机都是停机状态。当需要开启压缩机时，压缩机开启状态选择为`开机`，并填写压缩机转速和允许最大功率，单位W。

注意，压缩机转速和最大功率必须为非负整数。

填写示例：

![2](.\pic\2.png)

#### 电子膨胀阀

电子膨胀阀仅有一个可修改参数`EXV开度`，通过填写具体的开度值来控制其开度。在运行过程中可以看到初始化状态和运行状态的变化。

注意，EXV开度必须为非负整数。

填写示例：

![3](.\pic\3.png)

#### 三通阀

每一个三通阀仅有一个可修改参数`开度`。由于使用的三通阀为比例三通阀，开度为0-100中的任意非负整数。

三通阀每一次停机后再次设置都会有一个初始化过程（开度从0->100->0），然后才会转动到设置的位置上，但是不停机连续变化不需要初始化，会直接转动到对应位置上。

填写示例：

![4](.\pic\4.png)

#### 四通阀

每一个四通阀仅有一个可修改参数`模式`。直接从下拉框选择即可，等待四通阀转动完毕，状态栏中会显示当前的状态（转动需要事件，需要等待）。

填写示例：

![5](.\pic\5.png)

#### WPTC

每一个WPTC有两个可修改参数`目标温度`、`加热挡位`。加热挡位可以通过下拉框选择，目标温度手动输入整数温度。

在与下位机建立连接时，WPTC即可以显示状态信息，如果状态信息异常（如出现负值），首先检查通讯和硬件问题。

填写示例：

![6](.\pic\6.png)

#### PWM

直接填写占空比数值，只支持整数占空比（单位为%）。在下位机内写好逻辑，在上位机中填写的数据从 0 - 100 使元件的转速增大。

填写示例：

![7](.\pic\7.png)